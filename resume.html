<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harsh Kumar - Resume</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- Theme initialization to avoid flash of wrong theme -->
    <script>
        (function() {
            try {
                const stored = localStorage.getItem('theme');
                if (stored) {
                    document.documentElement.setAttribute('data-theme', stored);
                } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
                    document.documentElement.setAttribute('data-theme', 'light');
                } else {
                    document.documentElement.setAttribute('data-theme', 'dark');
                }
            } catch (e) {
                // ignore
            }
        })();
    </script>
    <style>
        /* Make the embedded PDF use full viewport height under navbar
           Use min-height and a scrollable container so small windows still allow viewing. */
        .pdf-container { padding-top: 80px; }
        .pdf-viewer-wrap { width: 100%; max-width: 1100px; margin: 0 auto; }
        .pdf-frame {
            width: 100%;
            /* prefer a responsive viewport-based height but enforce a reasonable minimum */
            height: calc(100vh - 140px);
            min-height: 480px;
            border: none;
            display: block;
        }

        /* On very short viewports (small windows or some mobile/devtools sizes), allow vertical scrolling */
        .pdf-container .pdf-frame-container {
            overflow: auto;
            max-height: calc(100vh - 140px);
        }

        @media (max-width: 768px) {
            .pdf-frame { min-height: 420px; height: 70vh; }
            .pdf-container { padding-top: 70px; }
        }
        @media (max-height: 520px) {
            .pdf-frame { min-height: 320px; }
        }
    </style>
</head>
<body>
    <nav id="navbar" class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="assets/images/logo-dark.png" alt="Logo" class="navbar-brand-img">
            </a>
            <!-- Theme toggle -->
            <button id="theme-toggle" class="btn btn-link text-decoration-none ms-3 d-flex align-items-center" aria-label="Toggle theme" title="Toggle theme">
                <i id="theme-icon" class="fa-regular fa-moon" style="font-size:20px;"></i>
            </button>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html#home">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#internships">Internships</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#projects">Projects</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#thesis">Thesis</a></li>
                    <li class="nav-item"><a class="nav-link active" href="resume.html">Resume</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#contact">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="pdf-container">
        <div class="pdf-viewer-wrap pdf-frame-container">
            <!-- Use <object> as primary PDF embed (better support across browsers); fall back to <embed> and a download link -->
            <object class="pdf-frame" data="assets/resume/harsh.pdf" type="application/pdf" aria-label="Resume PDF">
                <embed class="pdf-frame" src="assets/resume/harsh.pdf" type="application/pdf">
                </embed>
            </object>
        </div>
        <div style="text-align:center; margin: 12px 0; color: var(--text-light);">
            If the PDF doesn't render, <a href="assets/resume/harsh.pdf" download style="color:var(--accent-color);">download the resume</a>.
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        (function() {
            // Check if we should use iframe fallback immediately for Edge browsers
            function shouldUseIframeFallback() {
                var isEdge = /Edg\//.test(navigator.userAgent);
                return isEdge; // Use iframe for all Edge browsers due to PDF rendering issues
            }

            // If <object> fails to load PDF in some browsers/sizes, replace it with an iframe fallback
            function needsFallback(obj) {
                try {
                    // some browsers set a non-zero .contentDocument when loaded; object.error may be undefined
                    if (!obj) return true;
                    // If the object has no data or the type isn't application/pdf, fallback
                    if (!obj.getAttribute('data') || obj.getAttribute('type') !== 'application/pdf') return true;
                    // Attempt a lightweight feature-detect: object.contentDocument may be null for failed loads
                    // Note: Accessing contentDocument may throw on cross-origin in some browsers; wrap safely
                    try {
                        if (obj.contentDocument && obj.contentDocument.body && obj.contentDocument.body.childElementCount > 0) {
                            return false; // seems to have content
                        }
                    } catch (e) {
                        // ignore â€” assume object may be fine
                    }
                } catch (e) {
                    return true;
                }
                return false;
            }

            function replacePdfWithIframe() {
                var wrapper = document.querySelector('.pdf-viewer-wrap');
                if (!wrapper) return;
                var iframe = document.createElement('iframe');
                iframe.className = 'pdf-frame';
                iframe.setAttribute('src', 'assets/resume/harsh.pdf');
                iframe.setAttribute('aria-label', 'Resume PDF iframe fallback');
                iframe.setAttribute('loading', 'lazy');
                // replace object with iframe
                wrapper.innerHTML = '';
                wrapper.appendChild(iframe);
            }

            // For Edge browsers, use iframe immediately to avoid rendering issues
            if (shouldUseIframeFallback()) {
                document.addEventListener('DOMContentLoaded', function() {
                    replacePdfWithIframe();
                });
            } else {
                // For other browsers, check if fallback is needed after load
                document.addEventListener('DOMContentLoaded', function() {
                    var obj = document.querySelector('object.pdf-frame');
                    if (needsFallback(obj)) {
                        replacePdfWithIframe();
                    } else {
                        // Give the object a chance to load, then check again
                        setTimeout(function() {
                            if (needsFallback(obj)) {
                                replacePdfWithIframe();
                            }
                        }, 1000);
                    }
                });
            }
        })();
    </script>
</body>
</html>